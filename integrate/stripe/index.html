<!DOCTYPE html><html><head><meta charset="UTF-8"><meta name="viewport" content="initial-scale=1"><title>Integrate Keygen and Stripe together using webhooks</title><link rel="shortcut icon" href="data:image/x-icon;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQEAYAAABPYyMiAAAABmJLR0T///////8JWPfcAAAACXBIWXMAAABIAAAASABGyWs+AAAAF0lEQVRIx2NgGAWjYBSMglEwCkbBSAcACBAAAeaR9cIAAAAASUVORK5CYII" type="image/x-icon"><link rel="icon" href="/favicon-192x192.png" sizes="192x192"><link rel="apple-touch-icon" href="/apple-touch-icon.png" sizes="180x180"><link href="https://keygen.sh/media.jpg" rel="image_src"><meta content="Keygen - a dead-simple product and app licensing API built for developers" property="og:title"><meta content="https://keygen.sh/" property="og:url"><meta content="Keygen is a simple app and product licensing API, allowing developers to easily implement various licensing types into any online or desktop software product." property="og:description"><meta content="https://keygen.sh/media.jpg" property="og:image"><meta content="Keygen" property="og:site_name"><meta content="website" property="og:type"><link rel="stylesheet" href="/app.css"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-86857020-1', 'auto');
ga('send', 'pageview');</script></head><body><div class="container"><header class="header__wrapper"><div class="header"><a class="logo" href="/"><canvas class="logo__logomark" width="64" height="64"></canvas><span class="logo__logotype effect--shuffle">Keygen</span></a><nav class="navigation" id="nav"><div class="navigation__hamburger" id="nav-toggle"><i class="material-icons">menu</i></div><ul class="navigation__list"><li onclick=""><span>Products<i class="material-icons">expand_more</i></span><ul class="navigation__sublist"><li><a href="/licensing">Software Licensing</a></li><li><a href="/distribution">Distribution</a></li></ul></li><li><a href="/pricing" data-conversion="r_ssCOKoynMQw8CikwM">Pricing</a></li><li><a href="/docs" data-conversion="smILCPbF13MQw8CikwM">Documentation</a></li><li><a href="https://app.keygen.sh/login">Log in</a></li><li><a class="button button--size-small" href="https://app.keygen.sh/register" data-conversion="iInYCL2A0HMQw8CikwM">Sign Up</a></li></ul></nav></div></header><main class="main"><div class="main__title"><h1>Keygen<span>+</span>Stripe</h1></div><div class="main__content__wrapper"><div class="main__content integration"><h2 id="manage-payments-with-stripe-licensing-with-keygen">Manage payments with Stripe, licensing with Keygen</h2>
<p>In this example, we&#39;ll be working with a Node.js app that integrates Keygen and <a href="https://stripe.com">Stripe</a>
together using webhooks, allowing them to communicate with eachother, automating
our entire payment, user and license creation flow. We&#39;ll create a client-side
registration and payment form, while the rest will be handled server-side.</p>
<h4 id="-index-html-"><code>index.html</code></h4>
<pre><code class="lang-html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;title&gt;Purchase Software&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;h1&gt;Purchase Software&lt;/h1&gt;
    &lt;form id=&quot;register&quot;&gt;
      &lt;label for=&quot;first-name&quot;&gt;
        First name
      &lt;/label&gt;
      &lt;br&gt;
      &lt;input type=&quot;text&quot; name=&quot;first-name&quot; id=&quot;first-name&quot; value=&quot;Elliot&quot; required&gt;
      &lt;br&gt;
      &lt;label for=&quot;last-name&quot;&gt;
        Last name
      &lt;/label&gt;
      &lt;br&gt;
      &lt;input type=&quot;text&quot; name=&quot;last-name&quot; id=&quot;last-name&quot; value=&quot;Alderson&quot; required&gt;
      &lt;br&gt;
      &lt;label for=&quot;email&quot;&gt;
        Email
      &lt;/label&gt;
      &lt;br&gt;
      &lt;input type=&quot;email&quot; name=&quot;email&quot; id=&quot;email&quot; value=&quot;elliot@example.com&quot; required&gt;
      &lt;br&gt;
      &lt;label for=&quot;password&quot;&gt;
        Password
      &lt;/label&gt;
      &lt;br&gt;
      &lt;input type=&quot;password&quot; name=&quot;password&quot; id=&quot;password&quot; value=&quot;fsociety&quot; required&gt;
      &lt;br&gt;
      &lt;br&gt;
      &lt;button type=&quot;submit&quot;&gt;
        Buy Now
      &lt;/button&gt;
    &lt;/form&gt;
    &lt;script src=&quot;https://checkout.stripe.com/checkout.js&quot;&gt;&lt;/script&gt;
    &lt;script&gt;
      const STRIPE_PUBLISHABLE_KEY = &quot;&lt;%= STRIPE_PUBLISHABLE_KEY %&gt;&quot;
      const KEYGEN_ACCOUNT_ID = &quot;&lt;%= KEYGEN_ACCOUNT_ID %&gt;&quot;

      const register = document.getElementById(&quot;register&quot;)
      const handler = StripeCheckout.configure({
        key: STRIPE_PUBLISHABLE_KEY,
        token: async ({ id: stripeToken }) =&gt; {
          const attributes = {
            firstName: document.getElementById(&quot;first-name&quot;).value,
            lastName: document.getElementById(&quot;last-name&quot;).value,
            email: document.getElementById(&quot;email&quot;).value,
            password: document.getElementById(&quot;password&quot;).value,
            metadata: { stripeToken } // Temporarily store this so our webhooks can do their thing
          }

          // Create the Keygen user
          const response = await fetch(`https://api.keygen.sh/v1/accounts/${KEYGEN_ACCOUNT_ID}/users`, {
            method: &quot;POST&quot;,
            headers: {
              &quot;Content-Type&quot;: &quot;application/vnd.api+json&quot;,
              &quot;Accept&quot;: &quot;application/vnd.api+json&quot;
            },
            body: JSON.stringify({
              data: { type: &quot;users&quot;, attributes }
            })
          })

          const { data, errors } = await response.json()
          if (errors) {
            throw new Error(errors.map(e =&gt; e.detail).toString())
          }

          // All good! The webhooks will handle the rest. :)

          register.parentNode.innerHTML = `Thanks for your purchase, ${data.attributes.firstName}! ðŸ‘ŠðŸ’¥`
        }
      })

      register.addEventListener(&quot;submit&quot;, event =&gt; {
        event.preventDefault()

        handler.open({
          panelLabel: &quot;Purchase Software&quot;,
          name: &quot;Keygen&quot;
        })
      })
    &lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre>
<hr>
<div class="integration__actions">
  <a class="button button--fill-solid button--no-border" href="https://github.com/keygen-sh/example-stripe-integration">
    <i class="devicons devicons-github_badge"></i> View on GitHub
  </a>
</div>
</div></div></main><footer class="footer"><section class="cta"><div class="cta__content"><h2>Ready to get started?</h2><h3>Get in touch, or sign up today.</h3><a class="button" href="/pricing" data-conversion="r_ssCOKoynMQw8CikwM">View Pricing</a><a class="button button--secondary" href="mailto:sales@keygen.sh" data-conversion="2CTlCI_m6XQQw8CikwM">Contact Sales</a></div></section><div class="footer__content">Â© 2017 Keygen â€“ All Rights Reserved â€“ hello@keygen.sh</div><ul class="footer__links"><li><a href="https://status.keygen.sh">Status</a></li><li><a href="/privacy">Privacy</a></li><li><a href="/terms">Terms</a></li><li><a href="https://twitter.com/keygen_sh">Twitter</a></li></ul></footer></div><script src="/app.js"></script><script src="https://www.googleadservices.com/pagead/conversion_async.js"></script><script src="https://s3.amazonaws.com/downloads.mailchimp.com/js/signup-forms/popup/embed.js" data-dojo-config="usePlainJson: true, isDebug: false"></script><script>window.intercomSettings = {
  app_id: "zlzql92y"
};</script><script>(function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',intercomSettings);}else{var d=document;var i=function(){i.c(arguments)};i.q=[];i.c=function(args){i.q.push(args)};w.Intercom=i;function l(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/zlzql92y';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);}if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})()</script></body></html>